<!DOCTYPE html>
<html lang="en">

<head>
    <title>Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @font-face {
            font-family: "Inter";
            src: url("/fonts/Inter-Regular.ttf");
        }

        :root {
            --primary: #3b82f6;
            --primary-dark: #1e40af;
            --primary-darker: #1e3a8a;
            --secondary: #0ea5e9;
            --accent: #06b6d4;
            --dark-bg: #0f172a;
            --dark-card: #1e293b;
            --dark-card-hover: #334155;
            --text-light: #f1f5f9;
            --text-muted: #94a3b8;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --gradient: linear-gradient(135deg, var(--primary), var(--secondary));
            --gradient-dark: linear-gradient(135deg, var(--primary-dark), var(--primary-darker));
        }

        body {
            font-family: "Inter";
            background-color: var(--dark-bg);
            color: var(--text-light);
        }

        .card {
            background: var(--dark-card);
            border: none;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            border-color: rgba(59, 130, 246, 0.2);
        }

        .nav-link.active {
            background: var(--gradient) !important;
            color: var(--text-light) !important;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        .dashboard-container {
            margin: 40px auto;
            background-color: var(--dark-card);
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        h2 {
            font-weight: 600;
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: var(--text-light);
        }

        .upload-box {
            border: 2px dashed var(--text-muted);
            border-radius: 10px;
            text-align: center;
            padding: 40px;
            margin-bottom: 25px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.02);
        }

        .upload-box:hover {
            border-color: var(--primary);
            background: rgba(59, 130, 246, 0.05);
        }

        .upload-box p {
            color: var(--text-muted);
            margin-top: 10px;
        }

        .btn-upload {
            background-color: var(--primary);
            color: var(--text-light);
            border: none;
            margin-top: 10px;
            padding: 6px 20px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .btn-upload:hover {
            background-color: var(--primary-dark);
            transform: translateY(-1px);
        }

        .form-control,
        .form-select {
            background-color: var(--dark-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            transition: all 0.3s ease;
        }

        .form-control::placeholder,
        .form-select::placeholder {
            color: var(--text-muted);
        }

        .form-control:focus,
        .form-select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            background-color: var(--dark-card);
            color: var(--text-light);
        }

        textarea {
            resize: none;
        }

        .btn-post {
            background: var(--gradient);
            color: var(--text-light);
            border: none;
            width: 100%;
            padding: 12px;
            font-weight: 600;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .btn-post:hover {
            background: var(--gradient-dark);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
        }

        .custom-table-wrapper {
            background-color: var(--dark-card);
            color: var(--text-muted);
            border-radius: 12px;
            overflow: hidden;
            font-size: 14px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .custom-table {
            background: transparent !important;
            margin-bottom: 0;
            border-collapse: separate;
            border-spacing: 0;
        }

        .custom-table thead th {
            color: var(--text-muted);
            background: rgba(255, 255, 255, 0.05);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-weight: 600;
            padding: 16px 18px;
        }

        .custom-table tfoot td {
            color: var(--text-muted);
            background: rgba(255, 255, 255, 0.03);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-weight: 500;
        }

        .custom-table tbody tr {
            background: transparent;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .custom-table tbody tr:last-child {
            border-bottom: none;
        }

        .custom-table tbody td {
            color: var(--text-light);
            background: transparent !important;
            vertical-align: middle;
            padding: 16px 18px;
        }

        .custom-table tbody tr:hover td {
            background: rgba(255, 255, 255, 0.03);
        }

        .status-completed {
            background: var(--success);
            color: var(--text-light);
            font-size: 12px;
            padding: 4px 12px;
            border-radius: 12px;
        }

        .status-pending {
            background: var(--warning);
            color: var(--text-light);
            font-size: 12px;
            padding: 4px 12px;
            border-radius: 12px;
        }

        .status-active {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
            font-size: 12px;
            padding: 4px 12px;
            border-radius: 12px;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .icon-box {
            width: 20px;
            height: 36px;
            transition: all 0.3s ease;
        }

        .input-box {
            background-color: var(--dark-card);
            width: 100%;
            height: 40px;
            padding-left: 12px;
            padding-right: 12px;
            font-family: 'Inter';
            font-size: 14px;
            line-height: 22px;
            font-weight: 400;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            outline: none;
            color: var(--text-light);
            transition: all 0.3s ease;
        }

        .input-box:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .page-link {
            background-color: var(--dark-card) !important;
            color: var(--text-light) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            transition: all 0.3s ease;
        }

        .page-item.active .page-link {
            background: var(--gradient) !important;
            border-color: var(--primary) !important;
        }

        .page-link:hover {
            background-color: var(--dark-card-hover) !important;
            border-color: var(--primary) !important;
        }

        select#rowsPerPage {
            appearance: none;
            -moz-appearance: none;
            -webkit-appearance: none;
            background-image: none;
            padding-right: 10px;
            text-align: center;
            background-color: var(--dark-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            border-radius: 6px;
            font-size: 14px;
            height: 32px;
            transition: all 0.3s ease;
        }

        select#rowsPerPage:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .btn-primary {
            background: var(--gradient);
            border: none;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background: var(--gradient-dark);
            transform: translateY(-1px);
        }

        .modal-content {
            background-color: var(--dark-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .modal-header {
            background: var(--gradient);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .btn-secondary {
            background-color: var(--text-muted);
            border: none;
        }

        .btn-secondary:hover {
            background-color: var(--text-muted);
            opacity: 0.8;
        }

        .text-info {
            color: var(--primary) !important;
        }

        .text-danger {
            color: var(--error) !important;
        }

        .text-success {
            color: var(--success) !important;
        }

        /* Animation for file upload success */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .upload-success {
            animation: fadeIn 0.5s ease;
            color: var(--success) !important;
        }
    </style>
</head>

<body>

    <%- include('../partials/header') %>

        <div class="d-flex">

            <%- include('../partials/sidebar') %>

                <div class="flex-grow-1 p-4">
                    <%- include('../partials/tosta') %>
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h3 class="fw-bold" style="background: var(--gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Dashboard Overview</h3>
                            <button onclick="window.location.href='/user/postapproval'"
                                class="btn btn-primary rounded-3" style="font-size: 14px; height: 44px;">
                                <i class="bi bi-receipt text-white me-1"></i>Response
                            </button>
                        </div>

                        <div class="dashboard-container">
                            <form id="taskForm" method="POST" enctype="multipart/form-data">
                                <div class="upload-box" id="dropZone">
                                    <i id="icon" class="bi bi-cloud-upload fs-1" style="color: var(--text-muted);"></i>
                                    <p id="info" style="color: var(--text-muted);">Drag and drop files here, or click to browse</p>
                                    <label id="label" class="btn-upload">
                                        <input type="file" name="task_photo" id="taskPhotoInput" accept="image/*" hidden required>
                                        Upload Task Image
                                    </label>
                                </div>

                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label class="form-label" style="color: var(--text-light);">Task Title</label>
                                        <input name="title" type="text" class="form-control"
                                            placeholder="Enter Task Title..." required />
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label" style="color: var(--text-light);">Location</label>
                                        <input name="location" type="text" class="form-control"
                                            placeholder="Enter Location..." required />
                                    </div>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label" style="color: var(--text-light);">Brief Description</label>
                                    <textarea name="description" class="form-control" rows="4"
                                        placeholder="Describe your task details"></textarea>
                                </div>

                                <div class="row mb-3">
                                    <div class="col-md-4">
                                        <label class="form-label" style="color: var(--text-light);">Duration</label>
                                        <input name="duration" class="form-control" placeholder="e.g., 2 weeks">
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label" style="color: var(--text-light);">Deadline</label>
                                        <input name="deadline" type="datetime-local" class="form-control" />
                                    </div>
                                    <div class="col-md-4">
                                        <label class="form-label" style="color: var(--text-light);">Budget Offered</label>
                                        <input name="amount" type="number" class="form-control" placeholder="₹ 0" />
                                    </div>
                                </div>

                                <button type="submit" id="postBtn" class="btn-post" aria-busy="false" style="min-width: 140px;">
                                    <span class="spinner-border spinner-border-sm me-2 d-none" role="status" aria-hidden="true"></span>
                                    <span class="btn-label">Post Task</span>
                                </button>
                            </form>
                        </div>

                        <h5 class="fw-bold mb-3" style="color: var(--text-light);">My Posts</h5>
                        <div class="table-responsive custom-table-wrapper">
                            <table id="table" class="table table-borderless align-middle custom-table">
                                <thead>
                                    <tr>
                                        <th>Task ID</th>
                                        <th>Title</th>
                                        <th>Budget</th>
                                        <th class="text-center">Date</th>
                                        <th class="text-center">Deadline</th>
                                        <th class="text-center">Status</th>
                                        <th class="text-center">Action</th>
                                    </tr>
                                </thead>
                                <tbody id="tbody">
                                    <% tasks.forEach(task=> { %>
                                        <tr>
                                            <td>#<%= task._id.toString().slice(0, 6) %>...</td>
                                            <td><strong><%= task.title %></strong></td>
                                            <td class="text-success">+₹<%= task.amount %></td>
                                            <td class="text-center">
                                                <%= task.created_at ? new Date(task.created_at).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) : "N/A" %>
                                            </td>
                                            <td class="text-center">
                                                <%= task.deadline ? new Date(task.deadline).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) : "N/A" %>
                                            </td>
                                            <td class="text-center"><span class="status-active"><%= task.status %></span></td>
                                            <td class="d-flex justify-content-between align-items-center">
                                                <button type="button" data-id="<%= task._id %>" data-bs-toggle="modal"
                                                    data-bs-target="#editdata"
                                                    class="text-info me-2 bg-transparent border-0">
                                                    <img class="icon-box"
                                                        src="https://res.cloudinary.com/dqugwh4su/image/upload/v1761538423/edit_yaubxq.svg"
                                                        alt="Edit">
                                                </button>
                                                <button class="text-danger bg-transparent border-0 delete-btn"
                                                    data-id="<%= task._id %>">
                                                    <img class="icon-box"
                                                        src="https://res.cloudinary.com/dqugwh4su/image/upload/v1761538422/delete_nttln1.svg"
                                                        alt="Delete">
                                                </button>
                                            </td>
                                        </tr>
                                        <% }) %>
                                </tbody>
                                <tfoot>
                                    <tr>
                                        <td colspan="100%">
                                            <div class="d-flex justify-content-between align-items-center px-3 py-2 flex-wrap gap-2">
                                                <div class="d-flex align-items-center">
                                                    <span class="me-2" style="color: var(--text-muted);">Show</span>
                                                    <select id="rowsPerPage" class="form-select form-select-sm border-secondary">
                                                        <option value="5">5</option>
                                                        <option value="7" selected>7</option>
                                                        <option value="10">10</option>
                                                        <option value="20">20</option>
                                                    </select>
                                                    <span class="ms-2" style="color: var(--text-muted);">items per page</span>
                                                </div>
                                                <div id="showingInfo" class="text-center flex-grow-1" style="color: var(--text-muted);">
                                                    Showing 1 to 7 of 7 results
                                                </div>
                                                <div>
                                                    <ul id="pagination" class="pagination pagination-sm mb-0"></ul>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                </div>

                <!-- Edit Modal -->
                <div class="modal fade" id="editdata" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header border-bottom-0">
                                <h1 class="modal-title fs-5" id="exampleModalLabel" style="color: var(--text-light);">Edit Post</h1>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <label class="mb-2" style="font-size: 14px; color: var(--text-light);" for="">Service</label><br>
                                <input id="service" class="input-box" type="text" placeholder="Service title">
                                <label class="mb-2 mt-3" style="font-size: 14px; color: var(--text-light);" for="">Duration</label><br>
                                <input id="duration" class="input-box" type="text" placeholder="Duration">
                                <label class="mb-2 mt-3" style="font-size: 14px; color: var(--text-light);" for="">Deadline</label><br>
                                <input id="deadline" class="input-box" type="datetime-local" placeholder="Deadline">
                                <label class="mb-2 mt-3" style="font-size: 14px; color: var(--text-light);" for="">Amount</label><br>
                                <input id="amount" class="input-box" type="text" placeholder="Amount">
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary">Save changes</button>
                            </div>
                        </div>
                    </div>
                </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <!-- Your existing JavaScript remains exactly the same -->
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            const form = document.getElementById("taskForm");
            const postBtn = document.getElementById("postBtn");
            const postSpinner = postBtn.querySelector(".spinner-border");
            const postLabel = postBtn.querySelector(".btn-label");

            function setPosting(state) {
                postBtn.disabled = state; // prevent double submits
                postBtn.setAttribute("aria-busy", state ? "true" : "false"); // a11y busy state
                postSpinner.classList.toggle("d-none", !state); // show/hide spinner
                postLabel.textContent = state ? "Posting..." : "Post Task"; // update label
            }

            form.addEventListener("submit", async (e) => {
                e.preventDefault();
                setPosting(true);

                const formData = new FormData(e.target);

                try {
                    const response = await fetch("/user/createtask", {
                        method: "POST",
                        body: formData
                    });

                    const result = await response.json();

                    if (response.ok) {
                        showToast('success', 'Service Created Successfully!', 'Your job application has been successfully submitted.');
                        e.target.reset();
                        // keep loading until the page reloads
                        location.reload();
                    } else {
                        showToast('warning', 'Failed to create Service', 'There was an error submitting your application. Please try again.');
                        setPosting(false);
                    }
                } catch (error) {
                    showToast('error', 'Server Error!', error);
                    setPosting(false);
                }
            });





            // ✅ FIXED EDIT MODAL LOGIC
            document.getElementById("tbody").addEventListener("click", (e) => {
                const editBtn = e.target.closest("button[data-bs-toggle='modal']");
                if (!editBtn) return;

                const row = editBtn.closest("tr");
                const taskId = row.querySelector(".delete-btn").dataset.id;
                const title = row.children[1].innerText.trim();
                const amount = row.children[2].innerText.replace("+₹", "").trim();
                const deadline = row.children[4]?.innerText.trim() || "";
                const duration = row.children[3].innerText.trim();; // if not displayed in table, leave empty

                const modal = document.getElementById("editdata");
                modal.dataset.id = taskId;
                modal.querySelector("#service").value = title;
                modal.querySelector("#duration").value = duration;
                modal.querySelector("#amount").value = amount;
                modal.querySelector("#deadline").value = convertToDateInput(deadline);
            });

            // Helper Function
            function convertToDateInput(dateStr) {
                if (!dateStr) return "";
                const d = new Date(dateStr);
                return d.toISOString().slice(0, 16); // format for input type="datetime-local"
            }
            
            // ✅ SAVE EDIT
            document.querySelector("#editdata .btn-primary").addEventListener("click", async () => {
                const modal = document.getElementById("editdata");
                const taskId = modal.dataset.id;
                const title = modal.querySelector("#service").value;
                const amount = modal.querySelector("#amount").value;
                const duration = modal.querySelector("#duration").value;
                const deadline = modal.querySelector("#deadline").value;

                try {
                    const res = await fetch(`/user/updatetask/${taskId}`, {
                        method: "PUT",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({ title, amount, duration, deadline }),
                    });

                    const result = await res.json();
                    if (res.ok) {
                        showToast('success', 'Service Updated Successfully!', 'Your job application has been Updated successfully.')
                        bootstrap.Modal.getInstance(modal).hide();
                        setTimeout(() => location.reload(), 1000);
                    } else {
                        showToast('error', 'Failed to update Service', 'There was an error submitting your application. Please try again.')
                    }
                } catch (err) {
                    console.error("Error updating task:", err);
                    showToast('error', 'Server Error!', 'Try again later.');
                }
            });

            // ✅ DELETE FIX
           document.addEventListener('DOMContentLoaded', () => {
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', async function () {
                        const id = this.dataset.id;

                        // Dark theme base config
                        const swalDark = {
                            background: '#1e293b',  // dark slate
                            color: '#f1f5f9',       // light text
                            confirmButtonColor: '#ef4444', // red
                            cancelButtonColor: '#6b7280',
                        };

                        Swal.fire({
                            title: 'Are you sure?',
                            text: "This action will permanently delete the service.",
                            icon: 'warning',
                            showCancelButton: true,
                            confirmButtonText: 'Yes, delete it!',
                            cancelButtonText: 'Cancel',
                            ...swalDark
                        }).then(async (result) => {
                            if (result.isConfirmed) {
                                const response = await fetch(`/user/deletetask/${id}`, { method: 'DELETE' });

                                if (response.ok) {
                                    Swal.fire({
                                        icon: 'success',
                                        title: 'Service Deleted!',
                                        text: 'Your job application has been deleted successfully.',
                                        timer: 1500,
                                        showConfirmButton: false,
                                        ...swalDark
                                    });
                                    setTimeout(() => location.reload(), 1000);
                                } else {
                                    Swal.fire({
                                        icon: 'error',
                                        title: 'Delete Failed!',
                                        text: 'Try again later.',
                                        ...swalDark
                                    });
                                }
                            }
                        });
                    });
                });
            });
                        const btnupload = document.getElementById("label");
            const fileInput = document.getElementById("taskPhotoInput");
            const paragraph = document.getElementById("info");

            fileInput.addEventListener("change", function () {
                if (fileInput.files.length > 0) {
                    btnupload.style.display = "none";
                    document.getElementById("icon").style.display = "none";
                    paragraph.style.color = "#00bfa6";
                    paragraph.innerText = `✔ Image Selected: ${fileInput.files[0].name}`;
                }
            });
            document.addEventListener("DOMContentLoaded", () => {
                const tbody = document.querySelector("#table tbody");
                const rows = Array.from(tbody.querySelectorAll("tr"));
                const pagination = document.getElementById("pagination");
                const rowsPerPageSelect = document.getElementById("rowsPerPage");
                const showingInfo = document.getElementById("showingInfo");

                let currentPage = 1;
                let rowsPerPage = parseInt(rowsPerPageSelect.value);

                function displayPage(page) {
                    const start = (page - 1) * rowsPerPage;
                    const end = start + rowsPerPage;
                    rows.forEach((row, i) => {
                        row.style.display = (i >= start && i < end) ? "" : "none";
                    });
                    currentPage = page;
                    updatePagination();
                    updateShowingInfo();
                }

                function updatePagination() {
                    pagination.innerHTML = "";
                    const pageCount = Math.ceil(rows.length / rowsPerPage);

                    // Prev button
                    const prevLi = document.createElement("li");
                    prevLi.className = `page-item ${currentPage === 1 ? "disabled" : ""}`;
                    const prevA = document.createElement("a");
                    prevA.className = "btn btn-outline-light btn-sm me-2";
                    prevA.innerHTML = `<i class="bi bi-chevron-left"></i>`;
                    prevA.href = "#";
                    prevA.addEventListener("click", (e) => {
                        e.preventDefault();
                        if (currentPage > 1) displayPage(currentPage - 1);
                    });
                    prevLi.appendChild(prevA);
                    pagination.appendChild(prevLi);

                    // Current page indicator
                    const pageLi = document.createElement("li");
                    pageLi.className = "page-item active";
                    const pageA = document.createElement("a");
                    pageA.className = "page-link btn btn-outline-light btn-sm";
                    pageA.textContent = currentPage;
                    pageA.href = "#";
                    pageLi.appendChild(pageA);
                    pagination.appendChild(pageLi);

                    // Next button
                    const nextLi = document.createElement("li");
                    nextLi.className = `page-item ${currentPage === pageCount ? "disabled" : ""}`;
                    const nextA = document.createElement("a");
                    nextA.className = "btn btn-outline-light btn-sm ms-2";
                    nextA.innerHTML = `<i class="bi bi-chevron-right"></i>`;
                    nextA.href = "#";
                    nextA.addEventListener("click", (e) => {
                        e.preventDefault();
                        if (currentPage < pageCount) displayPage(currentPage + 1);
                    });
                    nextLi.appendChild(nextA);
                    pagination.appendChild(nextLi);
                }

                function updateShowingInfo() {
                    const start = (currentPage - 1) * rowsPerPage + 1;
                    const end = Math.min(start + rowsPerPage - 1, rows.length);
                    showingInfo.textContent = `Showing ${start} to ${end} of ${rows.length} results`;
                }

                rowsPerPageSelect.addEventListener("change", () => {
                    rowsPerPage = parseInt(rowsPerPageSelect.value);
                    currentPage = 1;
                    displayPage(currentPage);
                });

                if (rows.length > 0) displayPage(1);
            });
        </script>
</body>
</html>